<!DOCTYPE html>
<html>
<head>
    <title>Excel File Operations</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
</head>
<body>
    <input type="file" id="fileInput">
    <button onclick="importExcel()">Import Excel</button>
    <button onclick="exportExcel()">Export Excel</button>
    <div id="output"></div>

    <script>
        function importExcel() {
            const fileInput = document.getElementById('fileInput');
            const outputDiv = document.getElementById('output');

            const file = fileInput.files[0];
            const reader = new FileReader();

            reader.onload = function (e) {
                const data = e.target.result;
                const workbook = XLSX.read(data, { type: 'binary' });

                // Access the sheet and data as needed
                const sheetName = workbook.SheetNames[0];
                const sheet = workbook.Sheets[sheetName];
                const jsonData = XLSX.utils.sheet_to_json(sheet);

                // Display the imported data
                outputDiv.innerHTML = JSON.stringify(jsonData, null, 2);
            };

            reader.readAsBinaryString(file);
        }

        function exportExcel() {
            const jsonData = [
                { Name: 'John', Age: 30 },
                { Name: 'Alice', Age: 25 },
                { Name: 'Bob', Age: 35 },
            ];

            const worksheet = XLSX.utils.json_to_sheet(jsonData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');
            
            // Generate a blob and create a download link
            XLSX.writeFile(workbook, 'exported_data.xlsx');
        }
    </script>
</body>
</html>
